macro(add_contract CONTRACT_NAME TARGET)
  add_executable(${TARGET} ${ARGN})
  target_compile_options(${TARGET} PUBLIC -abigen)
  get_target_property(BINOUTPUT ${TARGET} BINARY_DIR)
  target_compile_options(${TARGET} PUBLIC -abigen_output=${BINOUTPUT}/${TARGET}.abi.json)
  target_compile_options(${TARGET} PUBLIC -exports_output=${BINOUTPUT}/${TARGET}.exports)
  target_compile_options(${TARGET} PUBLIC -abidef_output=${CMAKE_SOURCE_DIR}/${TARGET}_abi.cpp)
  target_link_options(${TARGET} PUBLIC -export-file=${BINOUTPUT}/${TARGET}.exports)
endmacro(add_contract)

macro(add_test_contract CONTRACT_NAME TARGET)
  add_executable(${TARGET} ${ARGN})
  get_target_property(BINOUTPUT ${TARGET} BINARY_DIR)
  target_link_options(${TARGET} PUBLIC -export="_Z4mainiPPc")
endmacro(add_test_contract)
