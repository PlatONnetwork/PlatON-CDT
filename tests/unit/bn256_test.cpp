//
// Created by yangzhou on 2/3/21.
//
#include "platon/crypto/bn256/bn256.hpp"
#include "platon/common.h"
#include "unit_test.hpp"
using namespace platon::crypto::bn256;
using namespace platon;

struct TestCase {
  std::vector<std::uint256_t> inputs;
  std::vector<std::uint256_t> expects;
};

struct PairingCase {
  std::vector<std::vector<std::uint256_t>> inputs;
  int32_t expects;
};

TEST_CASE(bn256_g1, add) {
  std::vector<TestCase> testcases = {
      {{"11169198337205317385038692134282557493133418158128574038999810944352461077961"_uint256,
        "2820885980102468247213289930888494165190958823101043243711917453290081841766"_uint256,
        "3510227910005969626168871163796842095937160976810256674232777209574668193517"_uint256,
        "2885800476071299445182650755020278501280179672256593791439003311512581969879"_uint256},
       {"15497584038690294240042153688304417339506091937513459124271972833238779664131"_uint256,
        "21762456842531143558012592863461237297422391564814111359902381816272400009493"_uint256}},
      {{"15497584038690294240042153688304417339506091937513459124271972833238779664131"_uint256,
        "21762456842531143558012592863461237297422391564814111359902381816272400009493"_uint256,
        "11169198337205317385038692134282557493133418158128574038999810944352461077961"_uint256,
        "2820885980102468247213289930888494165190958823101043243711917453290081841766"_uint256},
       {"19823850254741169819033785099293761935467223354323761392354670518001715552183"_uint256,
        "15097907474011103550430959168661954736283086276546887690628027914974507414020"_uint256}},
      {{"0"_uint256, "0"_uint256, "0"_uint256, "0"_uint256},
       {"0"_uint256, "0"_uint256}},
      {{"0"_uint256, "0"_uint256, "1"_uint256, "2"_uint256},
       {"1"_uint256, "2"_uint256}},
      {{"1"_uint256, "2"_uint256, "0"_uint256, "0"_uint256},
       {"1"_uint256, "2"_uint256}},
      {{"1"_uint256, "2"_uint256, "1"_uint256, "2"_uint256},
       {"1368015179489954701390400359078579693043519447331113978918064868415326638035"_uint256,
        "9918110051302171585080402603319702774565515993150576347155970296011118125764"_uint256}},
      {{"10744596414106452074759370245733544594153395043370666422502510773307029471145"_uint256,
        "848677436511517736191562425154572367705380862894644942948681172815252343932"_uint256,
        "1624070059937464756887933993293429854168590106605707304006200119738501412969"_uint256,
        "3269329550605213075043232856820720631601935657990457502777101397807070461336"_uint256},
       {"9836339169314901400584090930519505895878753154116006108033708428907043344230"_uint256,
        "2085718088180884207082818799076507077917184375787335400014805976331012093279"_uint256}}};
  for (size_t i = 0; i < testcases.size(); i++) {
    G1 g1(testcases[i].inputs[0], testcases[i].inputs[1]);
    G1 g2(testcases[i].inputs[2], testcases[i].inputs[3]);
    g1.Add(g2);
    ASSERT_EQ(std::to_string(g1.X()), std::to_string(testcases[i].expects[0]),
              std::to_string(g1.X()), std::to_string(testcases[i].expects[0]));
    ASSERT_EQ(std::to_string(g1.Y()), std::to_string(testcases[i].expects[1]),
              std::to_string(g1.Y()), std::to_string(testcases[i].expects[1]));
  }
}

TEST_CASE(bn256_g1, mul) {
  std::vector<TestCase> testcases = {
      {{"19823850254741169819033785099293761935467223354323761392354670518001715552183"_uint256,
        "15097907474011103550430959168661954736283086276546887690628027914974507414020"_uint256,
        "1230482048326178242"_uint256},
       {"3184834430741071145030522771540763108892281233703148152311693391954704539228"_uint256,
        "1405615944858121891163559530323310827496899969303520166098610312148921359100"_uint256}},
      {{"3184834430741071145030522771540763108892281233703148152311693391954704539228"_uint256,
        "1405615944858121891163559530323310827496899969303520166098610312148921359100"_uint256,
        "21888242871839275222246405745257275088696311157297823662689037894645226208582"_uint256},
       {"1064409792909579819393364125743501391733756505753915140796092525736117846715"_uint256,
        "21257373190851983314363281235348249082734408975409850550056292215582757527598"_uint256}},
      {{"1064409792909579819393364125743501391733756505753915140796092525736117846715"_uint256,
        "21257373190851983314363281235348249082734408975409850550056292215582757527598"_uint256,
        "10944121435919637611123202872628637544348155578648911831344518947322613104291"_uint256},
       {"9259362551934922528658229383019857932446630228276351809947689771713366184739"_uint256,
        "4949893740711918815800691317968353346030789241772947140308603735315158092327"_uint256}},
      {{"11999875504842010600789954262886096740416429265635183817701593963271973497827"_uint256,
        "11843594000332171325303933275547366297934113019079887694534126289021216356598"_uint256,
        "115792089237316195423570985008687907853269984665640564039457584007913129639935"_uint256},
       {"20294616021510367447732558209789807616121240178714320096510011758416540421185"_uint256,
        "12056772427755754528337291679245155002236489680385392876566977966802275601681"_uint256}},
      {{"11999875504842010600789954262886096740416429265635183817701593963271973497827"_uint256,
        "11843594000332171325303933275547366297934113019079887694534126289021216356598"_uint256,
        "21888242871839275222246405745257275088548364400416034343698204186575808495616"_uint256},
       {"11999875504842010600789954262886096740416429265635183817701593963271973497827"_uint256,
        "10044648871507103896942472469709908790762198138217935968154911605624009851985"_uint256}},
      {{"11999875504842010600789954262886096740416429265635183817701593963271973497827"_uint256,
        "11843594000332171325303933275547366297934113019079887694534126289021216356598"_uint256,
        "340282366920938463463374607431768211456"_uint256},
       {"7381312046702628178503712304781490671644042796664570543248412860605822622960"_uint256,
        "8754972776893197072790262539828927310429859210742735434230616848360641591387"_uint256}},
      {{"11999875504842010600789954262886096740416429265635183817701593963271973497827"_uint256,
        "11843594000332171325303933275547366297934113019079887694534126289021216356598"_uint256,
        "9"_uint256},
       {"13447195743588318540108422034660542894354216867239950480700468911927695682420"_uint256,
        "20282243652944194694550455553589850678366346583698568858716117082144718267765"_uint256}},
      {{"11999875504842010600789954262886096740416429265635183817701593963271973497827"_uint256,
        "11843594000332171325303933275547366297934113019079887694534126289021216356598"_uint256,
        "1"_uint256},
       {"11999875504842010600789954262886096740416429265635183817701593963271973497827"_uint256,
        "11843594000332171325303933275547366297934113019079887694534126289021216356598"_uint256}},
      {{"10744596414106452074759370245733544594153395043370666422502510773307029471145"_uint256,
        "848677436511517736191562425154572367705380862894644942948681172815252343932"_uint256,
        "115792089237316195423570985008687907853269984665640564039457584007913129639935"_uint256},
       {"18950371112020959534793178828158819231853457738238196874300219913665215864672"_uint256,
        "15691508526890250332993386064689277816272798722675871195210347901456702788529"_uint256}},
      {{"10744596414106452074759370245733544594153395043370666422502510773307029471145"_uint256,
        "848677436511517736191562425154572367705380862894644942948681172815252343932"_uint256,
        "21888242871839275222246405745257275088548364400416034343698204186575808495616"_uint256},
       {"10744596414106452074759370245733544594153395043370666422502510773307029471145"_uint256,
        "21039565435327757486054843320102702720990930294403178719740356721829973864651"_uint256}},
      {{"10744596414106452074759370245733544594153395043370666422502510773307029471145"_uint256,
        "848677436511517736191562425154572367705380862894644942948681172815252343932"_uint256,
        "340282366920938463463374607431768211456"_uint256},
       {"15424943888755408111165433845337686143222199257649279147900853501969340099196"_uint256,
        "17786462641823960567247183608750158908611228651573471759968104525474606751509"_uint256}},
      {{"10744596414106452074759370245733544594153395043370666422502510773307029471145"_uint256,
        "848677436511517736191562425154572367705380862894644942948681172815252343932"_uint256,
        "9"_uint256},
       {"15630250211619345980264659554171089045460684386745982646195304578474625146473"_uint256,
        "13597371564520873079214108010918820572395693243527082948219837354327653001066"_uint256}},
      {{"10744596414106452074759370245733544594153395043370666422502510773307029471145"_uint256,
        "848677436511517736191562425154572367705380862894644942948681172815252343932"_uint256,
        "1"_uint256},
       {"10744596414106452074759370245733544594153395043370666422502510773307029471145"_uint256,
        "848677436511517736191562425154572367705380862894644942948681172815252343932"_uint256}},
      {{"1624070059937464756887933993293429854168590106605707304006200119738501412969"_uint256,
        "3269329550605213075043232856820720631601935657990457502777101397807070461336"_uint256,
        "115792089237316195423570985008687907853269984665640564039457584007913129639935"_uint256},
       {"285581884218501472864293868073165696077463112349822881635552045749585959936"_uint256,
        "16340624069804843796427075670776773271360456296845632772469177020916744871972"_uint256}},
      {{"1624070059937464756887933993293429854168590106605707304006200119738501412969"_uint256,
        "3269329550605213075043232856820720631601935657990457502777101397807070461336"_uint256,
        "21888242871839275222246405745257275088548364400416034343698204186575808495616"_uint256},
       {"1624070059937464756887933993293429854168590106605707304006200119738501412969"_uint256,
        "18618913321234062147203172888436554457094375499307366159911936496838155747247"_uint256}},
      {{"1624070059937464756887933993293429854168590106605707304006200119738501412969"_uint256,
        "3269329550605213075043232856820720631601935657990457502777101397807070461336"_uint256,
        "340282366920938463463374607431768211456"_uint256},
       {"7437916709450835735994733793946878233842263792322626503849961157705620273002"_uint256,
        "21384137500841391433133045435420746384326026713770103788150615124596942771252"_uint256}},
      {{"1624070059937464756887933993293429854168590106605707304006200119738501412969"_uint256,
        "3269329550605213075043232856820720631601935657990457502777101397807070461336"_uint256,
        "9"_uint256},
       {"11744864753805541320111181058240501346617548818795024075343453303706881344088"_uint256,
        "17221384307920533803726063289029126335755140866379809678854881527846933441919"_uint256}},
      {{"1624070059937464756887933993293429854168590106605707304006200119738501412969"_uint256,
        "3269329550605213075043232856820720631601935657990457502777101397807070461336"_uint256,
        "1"_uint256},
       {"1624070059937464756887933993293429854168590106605707304006200119738501412969"_uint256,
        "3269329550605213075043232856820720631601935657990457502777101397807070461336"_uint256}},
  };
  for (size_t i = 0; i < testcases.size(); i++) {
    G1 g1(testcases[i].inputs[0], testcases[i].inputs[1]);
    g1.ScalarMul(testcases[i].inputs[2]);
    ASSERT_EQ(std::to_string(g1.X()), std::to_string(testcases[i].expects[0]),
              std::to_string(g1.X()), std::to_string(testcases[i].expects[0]));
  }
}

TEST_CASE(bn256_g2, add) {
  std::vector<TestCase> testcases = {
      {{"15108480512742213315752883275348732788054235236417790974273843355007533920341"_uint256,
        "7087423052184812752123031502782215229502029213326381531963693605124277246488"_uint256,
        "179853301121042839587000058223201906078907197410809512660027461703300819271"_uint256,
        "11875742517771222702411659323252914306253772862490535628642116117134675636023"_uint256,
        "19659919047260284629346094692123228544406542558959640466277696006830353021100"_uint256,
        "6025506379932237465385214201206527812848555421743710598697345947300890198457"_uint256,
        "20618922630881857155986522435001570406346639915859901858546051417452761970477"_uint256,
        "12957125681690452415152069341785043351437829970534786922248294088023103741201"_uint256},
       {"14042603979353047014699065068720942891153848066681887765205595127997210137589"_uint256,
        "4227215646657403102904984126716077524673514816933582588893784891564350096335"_uint256,
        "13483295412002387102843393789797104691321342217369902220657193831907008855087"_uint256,
        "526308351267687388207488653919006949083511001605733085229271778017690794939"_uint256}},
      {{"9774841635317751366832376443039044425723011253041735512511066434582357458038"_uint256,
        "14559853039970729945057078226699376002760051167071179188606308425727304615102"_uint256,
        "21675047719785317049315157896696055143943089513489716257977168266501392447204"_uint256,
        "12524502853992836501934928251873981080847805402351943896707081177608460273937"_uint256,
        "11441341743664608889945220516529015083164569327349991158246133707133233598816"_uint256,
        "9194398992672321680620930863541449508875486512619530709665794158464351686649"_uint256,
        "17214622371725824938340620687585751095165707398786728978358404025207355233355"_uint256,
        "6610010610539500338798363502949629621216159192217553184088443680137050037657"_uint256},
       {"98087315644938448174819795399781875933433463040451029200665936766680177082"_uint256,
        "10375881385210684739861074585482176394616506296355342580292153730638855102352"_uint256,
        "13318706110670198467828305645107151491607429132408286188960324134605290380768"_uint256,
        "12924218345915153329545772450512269744672526750323528948674463085586809255386"_uint256}},
      {{"21700085726069782601968081326021183220065062012373089461630557115291923715027"_uint256,
        "13727984374910138483670807381936787761986024795474412881713411186782127018067"_uint256,
        "6449752946288828682517072154980277208063929013745413364042274378325369444331"_uint256,
        "7211289541760817758594011630955836297782473940686644745767411076824883219961"_uint256,
        "7950602522861749413590539468950134663225146106477347556022317642944764099768"_uint256,
        "2524060324768668975676769385696288421248903389386357579356315455265388235700"_uint256,
        "1691700672662689919478397500856556465725164029453775899928677629553631795339"_uint256,
        "12121748128942053099931211780701448126148717524078308383915806241538755980753"_uint256},
       {"2046175611075841721501548396879044384075756523271096528825582377951202670959"_uint256,
        "19575427071232351014537563828145938367045205679094805438915188425009934175241"_uint256,
        "13981818803199863624555440355642525979415661179523761475324190885210438420777"_uint256,
        "3684011712384545359488425302541752744939036332393211253055657142589923038441"_uint256}},
      {{"12366030034910149833423243911424525413816777541284496011599259815772054409283"_uint256,
        "8740391074131984677074320782181586226706430900283091663602657479398416981525"_uint256,
        "4621726430993462099362364192568471963809482984737481931288300106342090778630"_uint256,
        "20984110206244233365681368620225636699623554865181548123593012068055334142783"_uint256,
        "16737131279073221504466524089883590094148598089246519639426522426825011679193"_uint256,
        "6648641343646309732894175311655406870912276856582121261496823591423252360493"_uint256,
        "15272313996027880668583072938936181618329390024499633049191605632511472943791"_uint256,
        "5030281174665933558913210869504439589201146511146400356797956797311534210280"_uint256},
       {"14501395128034418595851764253825958418457711361514098031656462519645351101285"_uint256,
        "2774266513793002239636383648262423780166170558673614779469514603891771711244"_uint256,
        "6066371300926550605285533999172711508324814216458623811838486796202386435765"_uint256,
        "4984699234986174716436154066487536109540915894503252430575107259936920076178"_uint256}}};
  for (size_t i = 0; i < testcases.size(); i++) {
    G2 g(testcases[i].inputs[0], testcases[i].inputs[1], testcases[i].inputs[2],
         testcases[i].inputs[3]);
    G2 g2(testcases[i].inputs[4], testcases[i].inputs[5],
          testcases[i].inputs[6], testcases[i].inputs[7]);
    g.Add(g2);
    ASSERT_EQ(std::to_string(g.X1()), std::to_string(testcases[i].expects[0]));
    ASSERT_EQ(std::to_string(g.Y1()), std::to_string(testcases[i].expects[1]));
    ASSERT_EQ(std::to_string(g.X2()), std::to_string(testcases[i].expects[2]));
    ASSERT_EQ(std::to_string(g.Y2()), std::to_string(testcases[i].expects[3]));
  }
}

TEST_CASE(bn256_g2, mul) {
  std::vector<TestCase> testcases = {
      {{"3696941135873307671247441964506892637584805298768842675607181465059517145309"_uint256,
        "10039451013746042673934866660497204315777078940443965797703514776224565569188"_uint256,
        "14016497437502770306816518586143435059355263067512679844168797281088606653953"_uint256,
        "2568712941682441320502053913210085917317448502923279268484174246773615910878"_uint256,
        "109560064477985382305818327797605276569020896330352418665828125580248893799519"_uint256},
       {"4353836535886827893129756751127682045715300830700456539582853191949317058281"_uint256,
        "12922543653438973644191969832052565327627633754943402858182708736456418435357"_uint256,
        "16159132638457876745466776662682289301270673949670087633695605779799593203813"_uint256,
        "10858522890915921460082951930370443624283962199025045310064649021468606491953"_uint256}},
      {{"16901946545716902241277660213729995815598388915523417536457165234976605799703"_uint256,
        "4055302053405285747224900883265497093103749396705105014925862464409169778553"_uint256,
        "16542213156074682320445348140365379626016239590945702296672745564225523516155"_uint256,
        "1867002752901029437330871473566823137215321688108990126330479767310285720614"_uint256,
        "86851587774064022918227695864905019986209769703279097175464641605068450667237"_uint256},
       {"12882708931170873383494383994126150225845510872975284518712043298431890039043"_uint256,
        "12926658397939035870311670077494466405076449229994101892198367812072026290158"_uint256,
        "10228911987079225941384731878262434647976222856279564051117071501654122399380"_uint256,
        "21702449072082977730522574139313382567691931458750859179067501940186292302136"_uint256}},
      {{"10407426018063737952276232040072850930546889567395933351544958655269530844175"_uint256,
        "12091104044106073550338419910083627724536195551920158005206267091153233805082"_uint256,
        "12184779555170967348706339015658831673999980328804074977328904007876823354713"_uint256,
        "1959161059524355474603658817778836340088374409332060970069553415364525101314"_uint256,
        "101212700120063555130207949136583134274804994251739829537209749218677406337047"_uint256},
       {"5403048425601782157649881919928562993382684169458808898017743408657349845762"_uint256,
        "8745733995867613585292011559817701016852551455473351414615717501543860018247"_uint256,
        "4087349245385066792327002268211976934520844258661530760225066497675703326852"_uint256,
        "15629808720615367929872174563408475231350868997754414576133751309680302128659"_uint256}},
      {{"581489801177438823689491269644666065824709807851238738519079364098618646849"_uint256,
        "20913384609927850913520714500941977746825762124701610233040294575804171277987"_uint256,
        "21302362567240674561790370190016303322998353268611439191965457863541355618812"_uint256,
        "7336521437134764610754091256470000632416925327072742523676577013517776454104"_uint256,
        "106273593953991211624987675879939776643235208341863837992383323305835900234381"_uint256},
       {"11989591772227896676411653339745364685995665450733346304201036495005726482582"_uint256,
        "3866393942132451666773161704663990622631280324334742333010827163060943504557"_uint256,
        "21822487161720903279757404091336887690501965078265201928602104594347664348251"_uint256,
        "10615452446823480159739904950110448554238850459392855640747901371970638781487"_uint256}}};

  for (size_t i = 0; i < testcases.size(); i++) {
    G2 g(testcases[i].inputs[0], testcases[i].inputs[1], testcases[i].inputs[2],
         testcases[i].inputs[3]);
    g.ScalarMul(testcases[i].inputs[4]);

    ASSERT_EQ(std::to_string(g.X1()), std::to_string(testcases[i].expects[0]));
    ASSERT_EQ(std::to_string(g.Y1()), std::to_string(testcases[i].expects[1]));
    ASSERT_EQ(std::to_string(g.X2()), std::to_string(testcases[i].expects[2]));
    ASSERT_EQ(std::to_string(g.Y2()), std::to_string(testcases[i].expects[3]));
  }
}

TEST_CASE(bn256, pairing) {
  std::vector<PairingCase> testcases = {
      {{{"12873740738727497448187997291915224677121726020054032516825496230827252793177"_uint256,
         "21804419174137094775122804775419507726154084057848719988004616848382402162497"_uint256,
         "14752851163271972921165116810778899752274893127848647655434033030151679466487"_uint256,
         "2146841959437886920191033516947821737903543682424168472444605468016078231160"_uint256,
         "19774899457345372253936887903062884289284519982717033379297427576421785416781"_uint256,
         "8159591693044959083845993640644415462154314071906244874217244895511876957520"_uint256},
        {"7742452358972543465462254569134860944739929848367563713587808717088650354556"_uint256,
         "14563720768440487558151020426243236708567496944263114635856508834497000371217"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256}},
       0},
      {{{"21163380042281667028194921861846440787793088615342153907557220755287297358850"_uint256,
         "1730005633951488561162401768080055521907218407650744548610087024095695199108"_uint256,
         "8176651290984905087450403379100573157708110416512446269839297438960217797614"_uint256,
         "15588556568726919713003060429893850972163943674590384915350025440408631945055"_uint256,
         "15347511022514187557142999444367533883366476794364262773195059233657571533367"_uint256,
         "4265071979090628150845437155927259896060451682253086069461962693761322642015"_uint256},
        {"2979746655438963305714517285593753729335852012083057917022078236006592638393"_uint256,
         "15417615390193197162481139584168488512191689144757183670202567060261951495633"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256}},
       0},
      {{{"6851077925310461602867742977619883934042581405263014789956638244065803308498"_uint256,
         "10336382210592135525880811046708757754106524561907815205241508542912494488506"_uint256,
         "21049232722760520884910305096518213957309396732908002623546433288382066807275"_uint256,
         "752476689148090443252690606274719847522796924289184281944322016120845872819"_uint256,
         "9346016947773545029940290874113526292203330783138316933543286726319309993747"_uint256,
         "10657101118636466197534311304303971390099046792106599174009327086566056805776"_uint256},
        {"12491625890066296859584468664467427202390981822868257437245835716136010795448"_uint256,
         "8069750353821819860927851864336026550878660569803647282773056804248652036897"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256}},
       0},
      {{{"21341087976609916409401737322664290631992568431163400450267978471171152600502"_uint256,
         "2942165230690572858696920423896381470344658299915828986338281196715687693170"_uint256,
         "17174171333098854828033634539500164902488935492941049779522958919502622588081"_uint256,
         "15684072703239714088748884492940919778409948011906556607893998678768263898205"_uint256,
         "2875949754418862832249955782188169764124161746616276218844232725526931423080"_uint256,
         "3086697999584045732786424745914779370086036468911841736272013630524944011227"_uint256},
        {"11045750300449228104954987621341377428147555267361007589958237713325787426824"_uint256,
         "8217403407518215550864283269843755778338432777831648146071091458082423360494"_uint256,
         "14123988352319117906018970862315159679452117471849989000282265698764599106398"_uint256,
         "18203970449465878141055527247672796515569702004956673464850250575302350363961"_uint256,
         "9070274571799942693810232181825350369966811716654884009331987967306715939422"_uint256,
         "3344169380239392314048474373026629561296701202792428464496597755254021991380"_uint256},
        {"9712873799510369170966410452086991795283841876597505062330138725142728449825"_uint256,
         "12454243299195962197215038257368341868343462743688334807261663369224579248346"_uint256,
         "8176651290984905087450403379100573157708110416512446269839297438960217797614"_uint256,
         "15588556568726919713003060429893850972163943674590384915350025440408631945055"_uint256,
         "15347511022514187557142999444367533883366476794364262773195059233657571533367"_uint256,
         "4265071979090628150845437155927259896060451682253086069461962693761322642015"_uint256}},
       0},
      {{{"14769660023513685328465446531781208618884675549025205007472633907767782249066"_uint256,
         "18898775868415629018342024437379517066076151603243019651890985159596448755745"_uint256,
         "8176651290984905087450403379100573157708110416512446269839297438960217797614"_uint256,
         "15588556568726919713003060429893850972163943674590384915350025440408631945055"_uint256,
         "15347511022514187557142999444367533883366476794364262773195059233657571533367"_uint256,
         "4265071979090628150845437155927259896060451682253086069461962693761322642015"_uint256},
        {"12091046215835229523641173286701717671667447745509192321596954139357866668225"_uint256,
         "7441435281888372745562860065409838320805406713886289227394084838087284766825"_uint256,
         "15147055940817099984713168864119185960995485721468434382981947300642935581737"_uint256,
         "4631727067030503710010688256995134761045201948838871620017875546783390086460"_uint256,
         "17623047202600292659611642134440671974256480551657416500487803939184025704533"_uint256,
         "21638878652776235365545898652250152098523031965244840843903617079107891864279"_uint256},
        {"6851077925310461602867742977619883934042581405263014789956638244065803308498"_uint256,
         "11551860661247139696365594698548517334589786595390008457447529351732731720077"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256}},
       0},
      {{{"12873740738727497448187997291915224677121726020054032516825496230827252793177"_uint256,
         "21804419174137094775122804775419507726154084057848719988004616848382402162497"_uint256,
         "14752851163271972921165116810778899752274893127848647655434033030151679466487"_uint256,
         "2146841959437886920191033516947821737903543682424168472444605468016078231160"_uint256,
         "19774899457345372253936887903062884289284519982717033379297427576421785416781"_uint256,
         "8159591693044959083845993640644415462154314071906244874217244895511876957520"_uint256},
        {"7742452358972543465462254569134860944739929848367563713587808717088650354556"_uint256,
         "7324522103398787664095385319014038380128814213034709026832529060148225837366"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256}},
       -1},
      {{{"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256}},
       -1},
      {{{"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "17805874995975841540914202342111839520379459829704422454583296818431106115052"_uint256,
         "13392588948715843804641432497768002650278120570034223513918757245338268106653"_uint256}},
       0},
      {{{"1"_uint256, "2"_uint256,
         "14583779054894525174450323658765874724019480979794335525732096752006891875705"_uint256,
         "18029695676650738226693292988307914797657423701064905010927197838374790804409"_uint256,
         "11474861747383700316476719153975578001603231366361248090558603872215261634898"_uint256,
         "2140229616977736810657479771656733941598412651537078903776637920509952744750"_uint256},
        {"1368015179489954701390400359078579693043519447331113978918064868415326638035"_uint256,
         "11970132820537103637166003141937572314130795164147247315533067598634108082819"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256}},
       0},
      {{{"7386018680896664845814314739404608274906642913094681192334051733974875574294"_uint256,
         "5852141382496003785706624430625245910156483599429242455944689364421678894028"_uint256,
         "2019050928575347605638490762886992026922085924959710776569383806797571971069"_uint256,
         "21740656624264531918905957436349160317178065932174634873434489096384118284193"_uint256,
         "9386111668168143378799867099066976687163019156923561176364278935596535020065"_uint256,
         "768940004759184688611731872359665907813921273999645987556749132562407031847"_uint256},
        {"1"_uint256, "2"_uint256,
         "11838207152290886924918158754888128755040578374158302623586388982144778515959"_uint256,
         "18547205523279150343907423763561667656905210989238825125041531932617195786591"_uint256,
         "21529909670613655107982420544538753603501207742700745772316790404883810220985"_uint256,
         "18914823083116165396144529068959135293951172901190760512481127643602037296501"_uint256}},
       0},
      {{{"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "17805874995975841540914202342111839520379459829704422454583296818431106115052"_uint256,
         "13392588948715843804641432497768002650278120570034223513918757245338268106653"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "17805874995975841540914202342111839520379459829704422454583296818431106115052"_uint256,
         "13392588948715843804641432497768002650278120570034223513918757245338268106653"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "17805874995975841540914202342111839520379459829704422454583296818431106115052"_uint256,
         "13392588948715843804641432497768002650278120570034223513918757245338268106653"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "17805874995975841540914202342111839520379459829704422454583296818431106115052"_uint256,
         "13392588948715843804641432497768002650278120570034223513918757245338268106653"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "17805874995975841540914202342111839520379459829704422454583296818431106115052"_uint256,
         "13392588948715843804641432497768002650278120570034223513918757245338268106653"_uint256}},
       0},
      {{{"1"_uint256, "2"_uint256,
         "14583779054894525174450323658765874724019480979794335525732096752006891875705"_uint256,
         "18029695676650738226693292988307914797657423701064905010927197838374790804409"_uint256,
         "11474861747383700316476719153975578001603231366361248090558603872215261634898"_uint256,
         "2140229616977736810657479771656733941598412651537078903776637920509952744750"_uint256},
        {"1368015179489954701390400359078579693043519447331113978918064868415326638035"_uint256,
         "11970132820537103637166003141937572314130795164147247315533067598634108082819"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "14583779054894525174450323658765874724019480979794335525732096752006891875705"_uint256,
         "18029695676650738226693292988307914797657423701064905010927197838374790804409"_uint256,
         "11474861747383700316476719153975578001603231366361248090558603872215261634898"_uint256,
         "2140229616977736810657479771656733941598412651537078903776637920509952744750"_uint256},
        {"1368015179489954701390400359078579693043519447331113978918064868415326638035"_uint256,
         "11970132820537103637166003141937572314130795164147247315533067598634108082819"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "14583779054894525174450323658765874724019480979794335525732096752006891875705"_uint256,
         "18029695676650738226693292988307914797657423701064905010927197838374790804409"_uint256,
         "11474861747383700316476719153975578001603231366361248090558603872215261634898"_uint256,
         "2140229616977736810657479771656733941598412651537078903776637920509952744750"_uint256},
        {"1368015179489954701390400359078579693043519447331113978918064868415326638035"_uint256,
         "11970132820537103637166003141937572314130795164147247315533067598634108082819"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "14583779054894525174450323658765874724019480979794335525732096752006891875705"_uint256,
         "18029695676650738226693292988307914797657423701064905010927197838374790804409"_uint256,
         "11474861747383700316476719153975578001603231366361248090558603872215261634898"_uint256,
         "2140229616977736810657479771656733941598412651537078903776637920509952744750"_uint256},
        {"1368015179489954701390400359078579693043519447331113978918064868415326638035"_uint256,
         "11970132820537103637166003141937572314130795164147247315533067598634108082819"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256},
        {"1"_uint256, "2"_uint256,
         "14583779054894525174450323658765874724019480979794335525732096752006891875705"_uint256,
         "18029695676650738226693292988307914797657423701064905010927197838374790804409"_uint256,
         "11474861747383700316476719153975578001603231366361248090558603872215261634898"_uint256,
         "2140229616977736810657479771656733941598412651537078903776637920509952744750"_uint256},
        {"1368015179489954701390400359078579693043519447331113978918064868415326638035"_uint256,
         "11970132820537103637166003141937572314130795164147247315533067598634108082819"_uint256,
         "11559732032986387107991004021392285783925812861821192530917403151452391805634"_uint256,
         "10857046999023057135944570762232829481370756359578518086990519993285655852781"_uint256,
         "4082367875863433681332203403145435568316851327593401208105741076214120093531"_uint256,
         "8495653923123431417604973247489272438418190587263600148770280649306958101930"_uint256}},
       0},
      {{{"7386018680896664845814314739404608274906642913094681192334051733974875574294"_uint256,
         "5852141382496003785706624430625245910156483599429242455944689364421678894028"_uint256,
         "2019050928575347605638490762886992026922085924959710776569383806797571971069"_uint256,
         "21740656624264531918905957436349160317178065932174634873434489096384118284193"_uint256,
         "9386111668168143378799867099066976687163019156923561176364278935596535020065"_uint256,
         "768940004759184688611731872359665907813921273999645987556749132562407031847"_uint256},
        {"1"_uint256, "2"_uint256,
         "11838207152290886924918158754888128755040578374158302623586388982144778515959"_uint256,
         "18547205523279150343907423763561667656905210989238825125041531932617195786591"_uint256,
         "21529909670613655107982420544538753603501207742700745772316790404883810220985"_uint256,
         "18914823083116165396144529068959135293951172901190760512481127643602037296501"_uint256}},
       0}};

  for (size_t i = 0; i < testcases.size(); i++) {
    std::vector<G1> g1s;
    std::vector<G2> g2s;
    for (size_t j = 0; j < testcases[i].inputs.size(); j++) {
      G1 g1(testcases[i].inputs[j][0], testcases[i].inputs[j][1]);
      G2 g2(testcases[i].inputs[j][2], testcases[i].inputs[j][3],
            testcases[i].inputs[j][4], testcases[i].inputs[j][5]);
      g1s.emplace_back(g1);
      g2s.emplace_back(g2);
    }

    int res = pairing(g1s, g2s);
    ASSERT_EQ(testcases[i].expects, res, "pos:", i,
              "expect:", testcases[i].expects, "actual:", res);
  }
}

UNITTEST_MAIN() {
  RUN_TEST(bn256_g1, add);
  RUN_TEST(bn256_g1, mul);
  RUN_TEST(bn256_g2, add);
  RUN_TEST(bn256_g2, mul);
  RUN_TEST(bn256, pairing);
}